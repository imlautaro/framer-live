(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{162:function(e,t,r){"use strict";r.r(t);class n{static hasCamera(){return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(e=>e.some(e=>"videoinput"===e.kind)).catch(()=>!1):Promise.resolve(!1)}constructor(video,e,t=this._onDecodeError.bind(this),r=n.DEFAULT_CANVAS_SIZE,o="environment"){this.$video=video,this.$canvas=document.createElement("canvas"),this._onDecode=e,this._preferredFacingMode=o,this._active=!1,this._paused=!1,this._flashOn=!1,"number"==typeof t?(r=t,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._onDecodeError=t,this.$canvas.width=r,this.$canvas.height=r,this._sourceRect={x:0,y:0,width:r,height:r},this._updateSourceRect=this._updateSourceRect.bind(this),this._onPlay=this._onPlay.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this.$video.playsInline=!0,this.$video.muted=!0,this.$video.disablePictureInPicture=!0,this.$video.addEventListener("loadedmetadata",this._updateSourceRect),this.$video.addEventListener("play",this._onPlay),document.addEventListener("visibilitychange",this._onVisibilityChange),this._qrEnginePromise=n.createQrEngine()}hasFlash(){if(!("ImageCapture"in window))return Promise.resolve(!1);const track=this.$video.srcObject?this.$video.srcObject.getVideoTracks()[0]:null;if(!track)return Promise.reject("Camera not started or not available");return new ImageCapture(track).getPhotoCapabilities().then(e=>e.fillLightMode.includes("flash")).catch(e=>(console.warn(e),!1))}isFlashOn(){return this._flashOn}toggleFlash(){return this._setFlash(!this._flashOn)}turnFlashOff(){return this._setFlash(!1)}turnFlashOn(){return this._setFlash(!0)}destroy(){this.$video.removeEventListener("loadedmetadata",this._updateSourceRect),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),this.stop(),n._postWorkerMessage(this._qrEnginePromise,"close")}start(){if(this._active&&!this._paused)return Promise.resolve();if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,this._paused=!1,document.hidden)return Promise.resolve();if(clearTimeout(this._offTimeout),this._offTimeout=null,this.$video.srcObject)return this.$video.play(),Promise.resolve();let e=this._preferredFacingMode;return this._getCameraStream(e,!0).catch(()=>(e="environment"===e?"user":"environment",this._getCameraStream())).then(t=>{e=this._getFacingMode(t)||e,this.$video.srcObject=t,this.$video.play(),this._setVideoMirror(e)}).catch(e=>{throw this._active=!1,e})}stop(){this.pause(),this._active=!1}pause(){this._paused=!0,this._active&&(this.$video.pause(),this._offTimeout||(this._offTimeout=setTimeout(()=>{const e=this.$video.srcObject?this.$video.srcObject.getTracks():[];for(const track of e)track.stop();this.$video.srcObject=null,this._offTimeout=null},300)))}static scanImage(e,t=null,r=null,canvas=null,o=!1,c=!1){const h=r instanceof Worker;let d=Promise.all([r||n.createQrEngine(),n._loadImage(e)]).then(([e,image])=>{let c;return r=e,[canvas,c]=this._drawToCanvas(image,t,canvas,o),r instanceof Worker?(h||r.postMessage({type:"inversionMode",data:"both"}),new Promise((e,t)=>{let o,h,d;h=c=>{"qrResult"===c.data.type&&(r.removeEventListener("message",h),r.removeEventListener("error",d),clearTimeout(o),null!==c.data.data?e(c.data.data):t(n.NO_QR_CODE_FOUND))},d=e=>{r.removeEventListener("message",h),r.removeEventListener("error",d),clearTimeout(o);const n=e?e.message||e:"Unknown Error";t("Scanner error: "+n)},r.addEventListener("message",h),r.addEventListener("error",d),o=setTimeout(()=>d("timeout"),1e4);const l=c.getImageData(0,0,canvas.width,canvas.height);r.postMessage({type:"decode",data:l},[l.data.buffer])})):new Promise((e,t)=>{const o=setTimeout(()=>t("Scanner error: timeout"),1e4);r.detect(canvas).then(r=>{r.length?e(r[0].rawValue):t(n.NO_QR_CODE_FOUND)}).catch(e=>t("Scanner error: "+(e.message||e))).finally(()=>clearTimeout(o))})});return t&&c&&(d=d.catch(()=>n.scanImage(e,null,r,canvas,o))),d=d.finally(()=>{h||n._postWorkerMessage(r,"close")}),d}setGrayscaleWeights(e,t,r,o=!0){n._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:e,green:t,blue:r,useIntegerApproximation:o})}setInversionMode(e){n._postWorkerMessage(this._qrEnginePromise,"inversionMode",e)}static createQrEngine(e=n.WORKER_PATH){return("BarcodeDetector"in window?BarcodeDetector.getSupportedFormats():Promise.resolve([])).then(t=>-1!==t.indexOf("qr_code")?new BarcodeDetector({formats:["qr_code"]}):new Worker(e))}_onPlay(){this._updateSourceRect(),this._scanFrame()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_updateSourceRect(){const e=Math.min(this.$video.videoWidth,this.$video.videoHeight),t=Math.round(2/3*e);this._sourceRect.width=this._sourceRect.height=t,this._sourceRect.x=(this.$video.videoWidth-t)/2,this._sourceRect.y=(this.$video.videoHeight-t)/2}_scanFrame(){if(!this._active||this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(()=>{this.$video.readyState<=1?this._scanFrame():this._qrEnginePromise.then(e=>n.scanImage(this.$video,this._sourceRect,e,this.$canvas,!0)).then(this._onDecode,e=>{if(!this._active)return;-1!==(e.message||e).indexOf("service unavailable")&&(this._qrEnginePromise=n.createQrEngine()),this._onDecodeError(e)}).then(()=>this._scanFrame())})}_onDecodeError(e){e!==n.NO_QR_CODE_FOUND&&console.log(e)}_getCameraStream(e,t=!1){const r=[{width:{min:1024}},{width:{min:768}},{}];return e&&(t&&(e={exact:e}),r.forEach(t=>t.facingMode=e)),this._getMatchingCameraStream(r)}_getMatchingCameraStream(e){return navigator.mediaDevices&&0!==e.length?navigator.mediaDevices.getUserMedia({video:e.shift()}).catch(()=>this._getMatchingCameraStream(e)):Promise.reject("Camera not found.")}_setFlash(e){return this.hasFlash().then(t=>t?this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:e}]}):Promise.reject("No flash available")).then(()=>this._flashOn=e)}_setVideoMirror(e){const t="user"===e?-1:1;this.$video.style.transform="scaleX("+t+")"}_getFacingMode(e){const t=e.getVideoTracks()[0];return t?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(image,e=null,canvas=null,t=!1){canvas=canvas||document.createElement("canvas");const r=e&&e.x?e.x:0,n=e&&e.y?e.y:0,o=e&&e.width?e.width:image.width||image.videoWidth,c=e&&e.height?e.height:image.height||image.videoHeight;t||canvas.width===o&&canvas.height===c||(canvas.width=o,canvas.height=c);const h=canvas.getContext("2d",{alpha:!1});return h.imageSmoothingEnabled=!1,h.drawImage(image,r,n,o,c,0,0,canvas.width,canvas.height),[canvas,h]}static _loadImage(e){if(e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||window.ImageBitmap&&e instanceof window.ImageBitmap||window.OffscreenCanvas&&e instanceof window.OffscreenCanvas)return Promise.resolve(e);if(e instanceof Image)return n._awaitImageLoad(e).then(()=>e);if(e instanceof File||e instanceof Blob||e instanceof URL||"string"==typeof e){const image=new Image;return e instanceof File||e instanceof Blob?image.src=URL.createObjectURL(e):image.src=e,n._awaitImageLoad(image).then(()=>((e instanceof File||e instanceof Blob)&&URL.revokeObjectURL(image.src),image))}return Promise.reject("Unsupported image type.")}static _awaitImageLoad(image){return new Promise((e,t)=>{if(image.complete&&0!==image.naturalWidth)e();else{let r,n;r=()=>{image.removeEventListener("load",r),image.removeEventListener("error",n),e()},n=()=>{image.removeEventListener("load",r),image.removeEventListener("error",n),t("Image load error")},image.addEventListener("load",r),image.addEventListener("error",n)}})}static _postWorkerMessage(e,t,data){return Promise.resolve(e).then(e=>{e instanceof Worker&&e.postMessage({type:t,data:data})})}}n.DEFAULT_CANVAS_SIZE=400,n.NO_QR_CODE_FOUND="No QR code found",n.WORKER_PATH="qr-scanner-worker.min.js";var o={data:function(){return{scanner:null,result:null}},mounted:function(){var e=this;this.scanner=new n(this.$refs.scanner,(function(t){e.result=t}))},methods:{scan:function(){this.scanner.start()}}},c=r(35),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("Hello world!")]),e._v(" "),r("div",{staticStyle:{width:"500px"},attrs:{id:"reader"}}),e._v(" "),r("video",{ref:"scanner"}),e._v(" "),r("button",{on:{click:function(t){return e.scan()}}},[e._v("Scan")]),e._v("\n    "+e._s(e.result)+"\n")])}),[],!1,null,null,null);t.default=component.exports}}]);